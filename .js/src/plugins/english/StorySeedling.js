var e=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,o){function i(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((n=n.apply(e,t||[])).next())}))},t=this&&this.__generator||function(e,t){var r,n,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(o=0)),o;)try{if(r=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};Object.defineProperty(exports,"__esModule",{value:!0});var r=require("@libs/fetch"),n=require("cheerio"),a=require("@libs/defaultCover"),o=function(){function o(){this.id="storyseedling",this.name="StorySeedling",this.icon="src/en/storyseedling/icon.png",this.site="https://storyseedling.com/",this.version="1.0.7"}return o.prototype.popularNovels=function(a){return e(this,void 0,void 0,(function(){var e,o,i,s,c,u,l=this;return t(this,(function(t){switch(t.label){case 0:return e=[],[4,(0,r.fetchApi)(this.site+"browse").then((function(e){return e.text()}))];case 1:return o=t.sent(),i=(0,n.load)(o),s=null===(u=i("div[ax-load][x-data]").attr("x-data"))||void 0===u?void 0:u.replace("browse('","").replace("')",""),(c=new FormData).append("search",""),c.append("orderBy","recent"),c.append("curpage",a.toString()),c.append("post",s),c.append("action","fetch_browse"),[4,(0,r.fetchApi)(this.site+"ajax",{body:c,method:"POST"}).then((function(e){return e.json()}))];case 2:return t.sent().data.posts.forEach((function(t){return e.push({name:t.title,cover:t.thumbnail,path:t.permalink.replace(l.site,"")})})),[2,e]}}))}))},o.prototype.parseNovel=function(o){return e(this,void 0,void 0,(function(){var e,i,s,c,u,l,p,h,d;return t(this,(function(t){switch(t.label){case 0:return e=this.site,i={path:o,name:""},[4,(0,r.fetchApi)(this.site+o).then((function(e){return e.text()}))];case 1:return s=t.sent(),c=(0,n.load)(s),i.name=c("h1").text().trim(),i.cover=c('img[x-ref="art"].w-full.rounded.shadow-md').attr("src"),i.cover||(i.cover=a.defaultCover),u=[],c("section[x-data=\"{ tab: location.hash.substr(1) || 'chapters' }\"].relative > div > div > div.flex.flex-wrap > a").each((function(){u.push(c(this).text().trim())})),i.genres=u.join(", "),i.summary=c("div.mb-4.order-2:not(.lg\\:grid-in-buttons)").text().trim().replace(/(\r\n|\n|\r)/gm,""),l=[],p=null===(d=c("div[ax-load][x-data]").attr("x-data"))||void 0===d?void 0:d.replace("toc('65335', '","").replace("')",""),(h=new FormData).append("post",p),console.log(p),console.log(o.replace("series","").replace("/","")),h.append("id",o.replace("series","").replace("/","")),h.append("action","series_toc"),[4,(0,r.fetchApi)(this.site+"ajax",{body:h,method:"POST"}).then((function(e){return e.json()}))];case 2:return t.sent().data.forEach((function(t){if(!t.is_locked){var r=t.date,n=t.title.split("-")[0].trim().split(" ")[1];l.push({name:t.title,path:t.url.replace(e,""),releaseTime:r,chapterNumber:parseInt(n)})}})),i.chapters=l,i.chapters.sort((function(e,t){var r,n;return(null!==(r=t.chapterNumber)&&void 0!==r?r:0)-(null!==(n=e.chapterNumber)&&void 0!==n?n:0)})),[2,i]}}))}))},o.prototype.parseChapter=function(a){return e(this,void 0,void 0,(function(){var e,o,i,s,c,u;return t(this,(function(t){switch(t.label){case 0:return[4,(0,r.fetchApi)(this.site+a).then((function(e){return e.text()}))];case 1:return e=t.sent(),o=(0,n.load)(e),i=o("body"),i.html()||"",s=a.split("/"),c=s[1],u=s[2],[4,(0,r.fetchApi)("http://93.219.34.136:3000/"+c+"/"+u).then((function(e){return e.text()}))];case 2:return[2,t.sent()||""]}}))}))},o.prototype.searchNovels=function(a,o){return e(this,void 0,void 0,(function(){var e,i,s,c,u,l,p=this;return t(this,(function(t){switch(t.label){case 0:return e=[],[4,(0,r.fetchApi)(this.site+"browse").then((function(e){return e.text()}))];case 1:return i=t.sent(),s=(0,n.load)(i),c=null===(l=s("div[ax-load][x-data]").attr("x-data"))||void 0===l?void 0:l.replace("browse('","").replace("')",""),(u=new FormData).append("search",a),u.append("orderBy","recent"),u.append("curpage",o.toString()),u.append("post",c),u.append("action","fetch_browse"),[4,(0,r.fetchApi)(this.site+"ajax",{body:u,method:"POST"}).then((function(e){return e.json()}))];case 2:return t.sent().data.posts.forEach((function(t){return e.push({name:t.title,cover:t.thumbnail,path:t.permalink.replace(p.site,"")})})),[2,e]}}))}))},o}();exports.default=new o;